
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Comprehensive development meeting transcript and technical specifications for implementing Management Agreement billing calculations with FIBO financial ontology classification and enterprise governance" name="description"/>
<link href="https://jonathan-aulson.github.io/Data_Product_TownePark/knowledge-corpus/meeting-transcripts/sprint28-management-agreement-development-meeting/" rel="canonical"/>
<link href="../development-sprint-retrospective-process-improvements-20250731/" rel="prev"/>
<link href="../sprint29-budget-actuals-development-meeting/" rel="next"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.15" name="generator"/>
<title>Sprint 28 Management Agreement Calculator Implementation - Development Meeting - Towne Park Data Product</title>
<link href="../../../assets/stylesheets/main.342714a4.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../stylesheets/extra.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#sprint-28-management-agreement-calculator-implementation-development-meeting">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Towne Park Data Product" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Towne Park Data Product">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Towne Park Data Product
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Sprint 28 Management Agreement Calculator Implementation - Development Meeting
            
          </span>
</div>
</div>
</div>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
        
  
  
    
  
  Home

      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../business-rules/fixed-fee-contract-configuration-business-rules/">
          
  
  
  Financial Entities

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../technical-specifications/edw-integration-technical-specification/">
          
  
  
  System Architecture

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../user-processes/ai-assisted-sprint-planning-process-guide/">
          
  
  
  Role-Based Processes

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../validation-reports/architecture-revenue-calculations-meeting-code-validation-report/">
          
  
  
  Validation Reports

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../12-month-forecast-architecture-planning-meeting-transcript-20250709/">
          
  
  
  Meeting Transcripts

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../standards/ai-content-safety-checklist/">
          
  
  
  Standards Framework

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../configuration/ai-development-tools-configuration-guide/">
          
  
  
  Configuration Guides

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Towne Park Data Product" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Towne Park Data Product">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"></path></svg>
</a>
    Towne Park Data Product
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
<span class="md-ellipsis">
    Home
    
  </span>
<span class="md-status md-status--Production"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Financial Entities
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Financial Entities
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
<span class="md-ellipsis">
    Business Rules
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
            Business Rules
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../business-rules/fixed-fee-contract-configuration-business-rules/">
<span class="md-ellipsis">
    Fixed Fee Contract Configuration Business Rules
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../business-rules/hybrid-contract-configuration-business-rules/">
<span class="md-ellipsis">
    Hybrid Contract Configuration Business Rules
    
  </span>
<span class="md-status md-status--Production"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../business-rules/management-agreement-contract-business-rules/">
<span class="md-ellipsis">
    Management Agreement Contract Business Rules
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../business-rules/per-labor-hour-contract-configuration-business-rules/">
<span class="md-ellipsis">
    Per Labor Hour Contract Configuration Business Rules
    
  </span>
<span class="md-status md-status--Production"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../business-rules/revenue-share-contract-business-rules/">
<span class="md-ellipsis">
    Revenue Share Contract Business Rules
    
  </span>
<span class="md-status md-status--Production"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../business-rules/forecasting-data-validation-business-rules/">
<span class="md-ellipsis">
    Forecasting Data Validation Business Rules
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    System Architecture
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            System Architecture
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../technical-specifications/edw-integration-technical-specification/">
<span class="md-ellipsis">
    EDW Integration Technical Specification
    
  </span>
<span class="md-status md-status--Draft"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../technical-specifications/revenue-datamart-daily-data-model/">
<span class="md-ellipsis">
    Revenue Datamart Daily Data Model
    
  </span>
<span class="md-status md-status--Production"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../technical-specifications/towne-park-forecasting-system-comprehensive-master-architecture/">
<span class="md-ellipsis">
    Towne Park Forecasting System Comprehensive Master Architecture
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    Role-Based Processes
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            Role-Based Processes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-processes/ai-assisted-sprint-planning-process-guide/">
<span class="md-ellipsis">
    AI-Assisted Sprint Planning Process Guide
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-processes/statement-management-user-process/">
<span class="md-ellipsis">
    Statement Management User Process
    
  </span>
<span class="md-status md-status--Production"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../user-processes/territory-admin-territory-management-procedures/">
<span class="md-ellipsis">
    Territory Administration Territory Management Procedures
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Validation Reports
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Validation Reports
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../validation-reports/architecture-revenue-calculations-meeting-code-validation-report/">
<span class="md-ellipsis">
    Architecture Revenue Calculations Meeting Code Validation
    
  </span>
<span class="md-status md-status--Validation Complete"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../validation-reports/management-agreement-contract-configuration-business-rules-code-validation-report/">
<span class="md-ellipsis">
    Management Agreement Business Rules Code Validation
    
  </span>
<span class="md-status md-status--Validated"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../validation-reports/validation-integrity-remediation-summary-2025-08-08/">
<span class="md-ellipsis">
    Validation Integrity Remediation Summary
    
  </span>
<span class="md-status md-status--Complete"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-ellipsis">
    Meeting Transcripts
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Meeting Transcripts
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../12-month-forecast-architecture-planning-meeting-transcript-20250709/">
<span class="md-ellipsis">
    12-Month Forecast Architecture Planning - July 2025
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../architecture-revenue-calculations-team-notes-20250805/">
<span class="md-ellipsis">
    Architecture &amp; Revenue Calculations Team Notes - August 2025
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../development-sprint-retrospective-process-improvements-20250731/">
<span class="md-ellipsis">
    Development Sprint Retrospective Process Improvements - July 2025
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Sprint 28 Management Agreement Development
    
  </span>
<span class="md-status md-status--Active"></span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Sprint 28 Management Agreement Development
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#executive-summary">
<span class="md-ellipsis">
      Executive Summary
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#meeting-details">
<span class="md-ellipsis">
      Meeting Details
    </span>
</a>
<nav aria-label="Meeting Details" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#participants-and-roles">
<span class="md-ellipsis">
      Participants and Roles
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fibo-financial-ontology-classification">
<span class="md-ellipsis">
      FIBO Financial Ontology Classification
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#technical-architecture-decisions">
<span class="md-ellipsis">
      Technical Architecture Decisions
    </span>
</a>
<nav aria-label="Technical Architecture Decisions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#calculator-framework-design">
<span class="md-ellipsis">
      Calculator Framework Design
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-flow-architecture">
<span class="md-ellipsis">
      Data Flow Architecture
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#detailed-calculator-specifications">
<span class="md-ellipsis">
      Detailed Calculator Specifications
    </span>
</a>
<nav aria-label="Detailed Calculator Specifications" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-management-fee-calculator-user-story-2423">
<span class="md-ellipsis">
      1. Management Fee Calculator (User Story 2423)
    </span>
</a>
<nav aria-label="1. Management Fee Calculator (User Story 2423)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#fixed-fee-branch">
<span class="md-ellipsis">
      Fixed Fee Branch
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#per-labor-hour-branch">
<span class="md-ellipsis">
      Per Labor Hour Branch
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#revenue-percentage-branch">
<span class="md-ellipsis">
      Revenue Percentage Branch
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-insurance-and-claims-calculator-user-story-2424">
<span class="md-ellipsis">
      2. Insurance and Claims Calculator (User Story 2424)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-non-gl-billable-expenses-calculator-user-story-2427">
<span class="md-ellipsis">
      3. Non-GL Billable Expenses Calculator (User Story 2427)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-profit-share-calculator-user-story-2426">
<span class="md-ellipsis">
      4. Profit Share Calculator (User Story 2426)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#user-story-breakdown-and-sprint-planning">
<span class="md-ellipsis">
      User Story Breakdown and Sprint Planning
    </span>
</a>
<nav aria-label="User Story Breakdown and Sprint Planning" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#story-point-allocation">
<span class="md-ellipsis">
      Story Point Allocation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sprint-28-execution-plan">
<span class="md-ellipsis">
      Sprint 28 Execution Plan
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#outstanding-questions-and-risk-assessment">
<span class="md-ellipsis">
      Outstanding Questions and Risk Assessment
    </span>
</a>
<nav aria-label="Outstanding Questions and Risk Assessment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#critical-clarifications-required">
<span class="md-ellipsis">
      Critical Clarifications Required
    </span>
</a>
<nav aria-label="Critical Clarifications Required" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-payroll-type-definitions">
<span class="md-ellipsis">
      1. Payroll Type Definitions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-claims-account-configuration">
<span class="md-ellipsis">
      2. Claims Account Configuration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-non-billable-expense-logic">
<span class="md-ellipsis">
      3. Non-Billable Expense Logic
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#risk-assessment-matrix">
<span class="md-ellipsis">
      Risk Assessment Matrix
    </span>
</a>
<nav aria-label="Risk Assessment Matrix" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#high-risk-items">
<span class="md-ellipsis">
      High Risk Items
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#medium-risk-items">
<span class="md-ellipsis">
      Medium Risk Items
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#integration-points-and-dependencies">
<span class="md-ellipsis">
      Integration Points and Dependencies
    </span>
</a>
<nav aria-label="Integration Points and Dependencies" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#existing-system-dependencies">
<span class="md-ellipsis">
      Existing System Dependencies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#new-system-requirements">
<span class="md-ellipsis">
      New System Requirements
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#api-integration-points">
<span class="md-ellipsis">
      API Integration Points
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-optimization-strategy">
<span class="md-ellipsis">
      Performance Optimization Strategy
    </span>
</a>
<nav aria-label="Performance Optimization Strategy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#current-performance-baseline">
<span class="md-ellipsis">
      Current Performance Baseline
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#optimization-techniques">
<span class="md-ellipsis">
      Optimization Techniques
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#monitoring-and-alerting">
<span class="md-ellipsis">
      Monitoring and Alerting
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#code-validation-and-quality-assurance">
<span class="md-ellipsis">
      Code Validation and Quality Assurance
    </span>
</a>
<nav aria-label="Code Validation and Quality Assurance" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#validation-requirements">
<span class="md-ellipsis">
      Validation Requirements
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing-strategy">
<span class="md-ellipsis">
      Testing Strategy
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#related-documentation-and-cross-references">
<span class="md-ellipsis">
      Related Documentation and Cross-References
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementation-audit-trail">
<span class="md-ellipsis">
      Implementation Audit Trail
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sprint29-budget-actuals-development-meeting/">
<span class="md-ellipsis">
    Sprint 29 Budget vs Actuals Development
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../sprint30-forecasting-variance-development-meeting/">
<span class="md-ellipsis">
    Sprint 30 Forecasting Variance Development
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../daily-scrum-development-progress-team-notes/">
<span class="md-ellipsis">
    Daily Scrum Development Progress
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    Standards Framework
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Standards Framework
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../standards/ai-content-safety-checklist/">
<span class="md-ellipsis">
    AI Content Safety Checklist
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-ellipsis">
    Configuration Guides
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            Configuration Guides
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../configuration/ai-development-tools-configuration-guide/">
<span class="md-ellipsis">
    AI Development Tools Configuration Guide
    
  </span>
<span class="md-status md-status--Active"></span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#executive-summary">
<span class="md-ellipsis">
      Executive Summary
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#meeting-details">
<span class="md-ellipsis">
      Meeting Details
    </span>
</a>
<nav aria-label="Meeting Details" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#participants-and-roles">
<span class="md-ellipsis">
      Participants and Roles
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fibo-financial-ontology-classification">
<span class="md-ellipsis">
      FIBO Financial Ontology Classification
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#technical-architecture-decisions">
<span class="md-ellipsis">
      Technical Architecture Decisions
    </span>
</a>
<nav aria-label="Technical Architecture Decisions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#calculator-framework-design">
<span class="md-ellipsis">
      Calculator Framework Design
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-flow-architecture">
<span class="md-ellipsis">
      Data Flow Architecture
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#detailed-calculator-specifications">
<span class="md-ellipsis">
      Detailed Calculator Specifications
    </span>
</a>
<nav aria-label="Detailed Calculator Specifications" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-management-fee-calculator-user-story-2423">
<span class="md-ellipsis">
      1. Management Fee Calculator (User Story 2423)
    </span>
</a>
<nav aria-label="1. Management Fee Calculator (User Story 2423)" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#fixed-fee-branch">
<span class="md-ellipsis">
      Fixed Fee Branch
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#per-labor-hour-branch">
<span class="md-ellipsis">
      Per Labor Hour Branch
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#revenue-percentage-branch">
<span class="md-ellipsis">
      Revenue Percentage Branch
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-insurance-and-claims-calculator-user-story-2424">
<span class="md-ellipsis">
      2. Insurance and Claims Calculator (User Story 2424)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-non-gl-billable-expenses-calculator-user-story-2427">
<span class="md-ellipsis">
      3. Non-GL Billable Expenses Calculator (User Story 2427)
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-profit-share-calculator-user-story-2426">
<span class="md-ellipsis">
      4. Profit Share Calculator (User Story 2426)
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#user-story-breakdown-and-sprint-planning">
<span class="md-ellipsis">
      User Story Breakdown and Sprint Planning
    </span>
</a>
<nav aria-label="User Story Breakdown and Sprint Planning" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#story-point-allocation">
<span class="md-ellipsis">
      Story Point Allocation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#sprint-28-execution-plan">
<span class="md-ellipsis">
      Sprint 28 Execution Plan
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#outstanding-questions-and-risk-assessment">
<span class="md-ellipsis">
      Outstanding Questions and Risk Assessment
    </span>
</a>
<nav aria-label="Outstanding Questions and Risk Assessment" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#critical-clarifications-required">
<span class="md-ellipsis">
      Critical Clarifications Required
    </span>
</a>
<nav aria-label="Critical Clarifications Required" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-payroll-type-definitions">
<span class="md-ellipsis">
      1. Payroll Type Definitions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-claims-account-configuration">
<span class="md-ellipsis">
      2. Claims Account Configuration
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-non-billable-expense-logic">
<span class="md-ellipsis">
      3. Non-Billable Expense Logic
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#risk-assessment-matrix">
<span class="md-ellipsis">
      Risk Assessment Matrix
    </span>
</a>
<nav aria-label="Risk Assessment Matrix" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#high-risk-items">
<span class="md-ellipsis">
      High Risk Items
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#medium-risk-items">
<span class="md-ellipsis">
      Medium Risk Items
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#integration-points-and-dependencies">
<span class="md-ellipsis">
      Integration Points and Dependencies
    </span>
</a>
<nav aria-label="Integration Points and Dependencies" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#existing-system-dependencies">
<span class="md-ellipsis">
      Existing System Dependencies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#new-system-requirements">
<span class="md-ellipsis">
      New System Requirements
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#api-integration-points">
<span class="md-ellipsis">
      API Integration Points
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-optimization-strategy">
<span class="md-ellipsis">
      Performance Optimization Strategy
    </span>
</a>
<nav aria-label="Performance Optimization Strategy" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#current-performance-baseline">
<span class="md-ellipsis">
      Current Performance Baseline
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#optimization-techniques">
<span class="md-ellipsis">
      Optimization Techniques
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#monitoring-and-alerting">
<span class="md-ellipsis">
      Monitoring and Alerting
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#code-validation-and-quality-assurance">
<span class="md-ellipsis">
      Code Validation and Quality Assurance
    </span>
</a>
<nav aria-label="Code Validation and Quality Assurance" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#validation-requirements">
<span class="md-ellipsis">
      Validation Requirements
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#testing-strategy">
<span class="md-ellipsis">
      Testing Strategy
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#related-documentation-and-cross-references">
<span class="md-ellipsis">
      Related Documentation and Cross-References
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementation-audit-trail">
<span class="md-ellipsis">
      Implementation Audit Trail
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="sprint-28-management-agreement-calculator-implementation-development-meeting">Sprint 28 Management Agreement Calculator Implementation - Development Meeting</h1>
<h2 id="executive-summary">Executive Summary</h2>
<p>This comprehensive sprint planning session established the technical architecture and implementation strategy for the Management Agreement billing calculator system. The team designed a sophisticated calculator framework using the strategy design pattern with ordered execution to handle complex financial calculations including management fees, insurance/claims processing, non-GL expenses, and profit sharing.</p>
<p><strong>Key Outcomes:</strong>
- <strong>Calculator Architecture</strong>: Strategy pattern with 4 specialized calculators
- <strong>Story Point Allocation</strong>: 44 points across 5 user stories
- <strong>Technical Complexity</strong>: High complexity due to intricate business rules and integration requirements
- <strong>Performance Considerations</strong>: ETL-based approach to minimize API call overhead</p>
<h2 id="meeting-details">Meeting Details</h2>
<p><strong>Date</strong>: July 2, 2025, 3:55 PM<br/>
<strong>Meeting Type</strong>: Sprint Tasking Session<br/>
<strong>Duration</strong>: Approximately 3 hours<br/>
<strong>Primary Focus</strong>: Management Agreement billing calculator architecture and implementation planning</p>
<h3 id="participants-and-roles">Participants and Roles</h3>
<ul>
<li><strong>Javier Casas</strong> - Developer</li>
<li><strong>Graham Olson</strong> - Developer  </li>
<li><strong>Cesar Figueroa</strong> - Technical Lead</li>
<li><strong>Andrew Scheuer</strong> - Developer/Architect</li>
<li><strong>Christopher Thompson</strong> - Senior Developer</li>
<li><strong>Jonathan Aulson</strong> - Product Owner/Business Analyst</li>
</ul>
<h2 id="fibo-financial-ontology-classification">FIBO Financial Ontology Classification</h2>
<p><strong>Primary Classification</strong>: <a href="../../FIBO-master-ontology/FND/Agreements/"><code>fibo-fnd-agr-ctr:MasterAgreement</code></a><br/>
<strong>Towne Park Extension</strong>: Management Agreement with complex calculation components<br/>
<strong>Regulatory Context</strong>: Financial reporting standards, hospitality industry regulations, SOX compliance</p>
<p><strong>Domain-Specific Properties:</strong>
- <strong>Management Fee Calculations</strong>: Fixed fee, per labor hour, and revenue percentage methods
- <strong>Insurance Processing</strong>: 5.77% payroll rate with vehicle insurance integration (account 7082)
- <strong>Claims Cap Logic</strong>: Per claim, annual calendar, and annual anniversary cap types
- <strong>Non-GL Expenses</strong>: Fixed amount, revenue percentage, and payroll percentage calculations
- <strong>Profit Share Processing</strong>: Tiered calculations with multiple accumulation types</p>
<h2 id="technical-architecture-decisions">Technical Architecture Decisions</h2>
<h3 id="calculator-framework-design">Calculator Framework Design</h3>
<p><strong>Architectural Pattern</strong>: Strategy Design Pattern with Ordered Execution</p>
<p><strong>Core Interface Definition</strong>:
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="k">interface</span><span class="w"> </span><span class="n">IManagementAgreementCalculator</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ExecutionOrder</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">get</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">Task</span><span class="o">&lt;</span><span class="n">CalculationResult</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CalculateAsync</span><span class="p">(</span><span class="n">CalculationContext</span><span class="w"> </span><span class="n">context</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Calculator Components Identified</strong>:
1. <strong>Management Fee Calculator</strong> (Order: 1)
2. <strong>Insurance and Claims Calculator</strong> (Order: 2)
3. <strong>Non-GL Billable Expenses Calculator</strong> (Order: 3)
4. <strong>Profit Share Calculator</strong> (Order: 4)</p>
<p><strong>Integration Architecture</strong>:
- Each calculator implements <code>IManagementAgreementCalculator</code> interface
- Results aggregate into Internal Revenue calculation system
- Execution order enforced through calculator ordering system
- Dependency injection for calculator registration and execution</p>
<h3 id="data-flow-architecture">Data Flow Architecture</h3>
<p><strong>ETL Process Enhancements Required</strong>:
<div class="highlight"><pre><span></span><code><span class="c1">-- New columns required in BillableExpenseBudget table</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">BillableExpenseBudget</span><span class="w"> </span>
<span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">vehicle_insurance_budget</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">claims_accounts_total</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</code></pre></div></p>
<p><strong>ETL Integration Requirements</strong>:
- Add vehicle insurance account (7082) to billable expense budget table
- Add claims accounts (7099, 7100, etc.) aggregation column
- Ensure enabled/disabled account filtering in ETL queries
- Pre-calculate common values to minimize real-time API calls</p>
<p><strong>Performance Optimization Strategy</strong>:
- <strong>Current Baseline</strong>: P&amp;L API call takes 26 seconds for 2 sites
- <strong>Approach</strong>: ETL-based data population over real-time API calls
- <strong>Caching Strategy</strong>: Cache frequently accessed configuration data
- <strong>Batch Processing</strong>: Process similar contract types together</p>
<h2 id="detailed-calculator-specifications">Detailed Calculator Specifications</h2>
<h3 id="1-management-fee-calculator-user-story-2423">1. Management Fee Calculator (User Story 2423)</h3>
<p><strong>FIBO Classification</strong>: <a href="../../FIBO-master-ontology/FBC/"><code>fibo-fbc-dae-dbt:Fee</code></a> with management service context</p>
<p><strong>Calculation Logic Branches</strong>:</p>
<h4 id="fixed-fee-branch">Fixed Fee Branch</h4>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">managementAgreement</span><span class="p">.</span><span class="n">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ManagementAgreementType</span><span class="p">.</span><span class="n">FixedFee</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">managementAgreement</span><span class="p">.</span><span class="n">FixedFeeAmount</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="per-labor-hour-branch">Per Labor Hour Branch</h4>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">managementAgreement</span><span class="p">.</span><span class="n">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ManagementAgreementType</span><span class="p">.</span><span class="n">PerLaborHour</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">forecastedHours</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetForecastedHours</span><span class="p">(</span><span class="n">managementAgreement</span><span class="p">.</span><span class="n">JobCode</span><span class="p">);</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">hourlyRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">managementAgreement</span><span class="p">.</span><span class="n">HourlyRate</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">forecastedHours</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hourlyRate</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="revenue-percentage-branch">Revenue Percentage Branch</h4>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">managementAgreement</span><span class="p">.</span><span class="n">Type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ManagementAgreementType</span><span class="p">.</span><span class="n">RevenuePercentage</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">externalRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetForecastedExternalRevenue</span><span class="p">();</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">percentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">managementAgreement</span><span class="p">.</span><span class="n">RevenuePercentage</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">externalRevenue</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">percentage</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Data Sources Required</strong>:
- Management agreement configuration (fixed fee, rates, percentages)
- Forecasted hours by job code from Legion integration
- External revenue calculations from forecasting system
- Escalator configurations for rate adjustments</p>
<p><strong>Business Rules</strong>:
- All configuration data available in management agreement component
- Escalator logic follows standard escalation patterns
- Output feeds into Internal Revenue total calculation
- Supports multiple calculation methods per contract</p>
<h3 id="2-insurance-and-claims-calculator-user-story-2424">2. Insurance and Claims Calculator (User Story 2424)</h3>
<p><strong>FIBO Classification</strong>: <a href="../../FIBO-master-ontology/FBC/"><code>fibo-fbc-dae-dbt:Insurance</code></a> with claims processing extension</p>
<p><strong>Insurance Calculation Logic</strong>:
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="kt">decimal</span><span class="w"> </span><span class="nf">CalculateInsurance</span><span class="p">(</span><span class="n">ManagementAgreement</span><span class="w"> </span><span class="n">agreement</span><span class="p">,</span><span class="w"> </span><span class="n">PayrollData</span><span class="w"> </span><span class="n">payroll</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">agreement</span><span class="p">.</span><span class="n">InsuranceType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">InsuranceType</span><span class="p">.</span><span class="n">FixedFee</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">FixedInsuranceAmount</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Percentage-based calculation</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">baseInsurance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">payroll</span><span class="p">.</span><span class="n">BaseAmount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.0577m</span><span class="p">;</span><span class="w"> </span><span class="c1">// 5.77% of forecasted payroll</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">vehicleInsurance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetVehicleInsuranceBudget</span><span class="p">(</span><span class="n">agreement</span><span class="p">.</span><span class="n">SiteId</span><span class="p">);</span><span class="w"> </span><span class="c1">// Account 7082</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">additionalPercentage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">AdditionalInsurancePercentage</span><span class="w"> </span><span class="o">??</span><span class="w"> </span><span class="mf">0m</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">baseInsurance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">vehicleInsurance</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">payroll</span><span class="p">.</span><span class="n">BaseAmount</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">additionalPercentage</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Claims Processing Logic</strong>:
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="kt">decimal</span><span class="w"> </span><span class="nf">CalculateClaims</span><span class="p">(</span><span class="n">ManagementAgreement</span><span class="w"> </span><span class="n">agreement</span><span class="p">,</span><span class="w"> </span><span class="n">ClaimsData</span><span class="w"> </span><span class="n">claims</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">agreement</span><span class="p">.</span><span class="n">ClaimsEnabled</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0m</span><span class="p">;</span>

<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">claimsTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetClaimsAccountsTotal</span><span class="p">(</span><span class="n">agreement</span><span class="p">.</span><span class="n">SiteId</span><span class="p">);</span><span class="w"> </span><span class="c1">// Accounts 7099, 7100, etc.</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">ClaimsCapType</span><span class="w"> </span><span class="k">switch</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">ClaimsCapType</span><span class="p">.</span><span class="n">PerClaim</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">claimsTotal</span><span class="p">,</span><span class="w"> </span><span class="c1">// No cap applied</span>
<span class="w">        </span><span class="n">ClaimsCapType</span><span class="p">.</span><span class="n">AnnualCalendar</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ApplyAnnualCalendarCap</span><span class="p">(</span><span class="n">claimsTotal</span><span class="p">,</span><span class="w"> </span><span class="n">agreement</span><span class="p">),</span>
<span class="w">        </span><span class="n">ClaimsCapType</span><span class="p">.</span><span class="n">AnnualAnniversary</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">ApplyAnnualAnniversaryCap</span><span class="p">(</span><span class="n">claimsTotal</span><span class="p">,</span><span class="w"> </span><span class="n">agreement</span><span class="p">),</span>
<span class="w">        </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">claimsTotal</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Complex Claims Cap Logic</strong>:
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="kt">decimal</span><span class="w"> </span><span class="nf">ApplyAnnualCalendarCap</span><span class="p">(</span><span class="kt">decimal</span><span class="w"> </span><span class="n">currentClaims</span><span class="p">,</span><span class="w"> </span><span class="n">ManagementAgreement</span><span class="w"> </span><span class="n">agreement</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">yearToDateClaims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetYearToDateClaims</span><span class="p">(</span><span class="n">agreement</span><span class="p">.</span><span class="n">SiteId</span><span class="p">,</span><span class="w"> </span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">Year</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">yearToDateClaims</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">AnnualClaimsCap</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">excessAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yearToDateClaims</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">AnnualClaimsCap</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// Subtract excess from billable expense total</span>
<span class="w">        </span><span class="n">SubtractFromBillableExpenses</span><span class="p">(</span><span class="n">excessAmount</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">AnnualClaimsCap</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">currentClaims</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">private</span><span class="w"> </span><span class="kt">decimal</span><span class="w"> </span><span class="nf">ApplyAnnualAnniversaryCap</span><span class="p">(</span><span class="kt">decimal</span><span class="w"> </span><span class="n">currentClaims</span><span class="p">,</span><span class="w"> </span><span class="n">ManagementAgreement</span><span class="w"> </span><span class="n">agreement</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">contractYearClaims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetContractYearClaims</span><span class="p">(</span><span class="n">agreement</span><span class="p">.</span><span class="n">SiteId</span><span class="p">,</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">ContractStartDate</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">contractYearClaims</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">AnnualClaimsCap</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">excessAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">contractYearClaims</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">AnnualClaimsCap</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// Subtract excess from billable expense total</span>
<span class="w">        </span><span class="n">SubtractFromBillableExpenses</span><span class="p">(</span><span class="n">excessAmount</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">AnnualClaimsCap</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">currentClaims</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>ETL Requirements</strong>:
- <strong>New Column</strong>: <code>vehicle_insurance_budget</code> (account 7082)
- <strong>New Column</strong>: <code>claims_accounts_total</code> (sum of 7099, 7100, etc.)
- <strong>Filter Logic</strong>: Include only enabled accounts in calculations
- <strong>Historical Data</strong>: Support for year-to-date and contract-year claims aggregation</p>
<h3 id="3-non-gl-billable-expenses-calculator-user-story-2427">3. Non-GL Billable Expenses Calculator (User Story 2427)</h3>
<p><strong>FIBO Classification</strong>: <a href="../../FIBO-master-ontology/FBC/"><code>fibo-fbc-dae-dbt:Expense</code></a> with non-general-ledger context</p>
<p><strong>Processing Logic</strong>:
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="kt">decimal</span><span class="w"> </span><span class="nf">CalculateNonGLExpenses</span><span class="p">(</span><span class="n">ManagementAgreement</span><span class="w"> </span><span class="n">agreement</span><span class="p">,</span><span class="w"> </span><span class="n">CalculationContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">agreement</span><span class="p">.</span><span class="n">NonGLExpensesEnabled</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="mf">0m</span><span class="p">;</span>

<span class="w">    </span><span class="kt">decimal</span><span class="w"> </span><span class="n">totalExpenses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0m</span><span class="p">;</span>

<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">expense</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">NonGLExpenses</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">totalExpenses</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">expense</span><span class="p">.</span><span class="n">Type</span><span class="w"> </span><span class="k">switch</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">NonGLExpenseType</span><span class="p">.</span><span class="n">FixedAmount</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">expense</span><span class="p">.</span><span class="n">Amount</span><span class="p">,</span>
<span class="w">            </span><span class="n">NonGLExpenseType</span><span class="p">.</span><span class="n">PercentOfRevenue</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="n">ExternalRevenue</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">expense</span><span class="p">.</span><span class="n">Percentage</span><span class="p">,</span>
<span class="w">            </span><span class="n">NonGLExpenseType</span><span class="p">.</span><span class="n">PercentOfPayroll</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GetPayrollAmount</span><span class="p">(</span><span class="n">expense</span><span class="p">.</span><span class="n">PayrollType</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">expense</span><span class="p">.</span><span class="n">Percentage</span><span class="p">,</span>
<span class="w">            </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mf">0m</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">totalExpenses</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Payroll Type Clarification Required</strong>:
- <strong>Billable Payroll</strong>: Base amount from PTEB calculation
- <strong>Total Payroll</strong>: Base amount + PTEB total from P&amp;L column
- <strong>Action Required</strong>: Confirmation with Jonathan Aulson on exact definitions and source locations</p>
<p><strong>Data Sources</strong>:
- Non-GL expense table (expense title, amount, type)
- External revenue calculations from forecasting system
- PTEB calculation outputs for payroll base amounts
- Payroll expense data from EDW integration</p>
<h3 id="4-profit-share-calculator-user-story-2426">4. Profit Share Calculator (User Story 2426)</h3>
<p><strong>FIBO Classification</strong>: <a href="../../FIBO-master-ontology/FBC/"><code>fibo-fbc-dae-dbt:ProfitShare</code></a> with tiered calculation extension</p>
<p><strong>Revenue Calculation Formula</strong>:
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="kt">decimal</span><span class="w"> </span><span class="nf">CalculateProfitShareRevenue</span><span class="p">(</span><span class="n">CalculationContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="n">ExternalRevenue</span><span class="w"> </span>
<span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="n">ManagementFeeTotal</span>
<span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="n">InsuranceAndClaimsTotal</span><span class="w">  </span>
<span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="n">BillableAccountsTotal</span>
<span class="w">           </span><span class="o">-</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="n">NonGLBillableExpensesTotal</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Threshold Processing Logic</strong>:
<div class="highlight"><pre><span></span><code><span class="k">public</span><span class="w"> </span><span class="kt">decimal</span><span class="w"> </span><span class="nf">CalculateProfitShare</span><span class="p">(</span><span class="n">ManagementAgreement</span><span class="w"> </span><span class="n">agreement</span><span class="p">,</span><span class="w"> </span><span class="kt">decimal</span><span class="w"> </span><span class="n">profitShareRevenue</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">var</span><span class="w"> </span><span class="n">accumulatedRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">AccumulationType</span><span class="w"> </span><span class="k">switch</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">AccumulationType</span><span class="p">.</span><span class="n">Monthly</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">profitShareRevenue</span><span class="p">,</span><span class="w"> </span><span class="c1">// Current month only</span>
<span class="w">        </span><span class="n">AccumulationType</span><span class="p">.</span><span class="n">AnnualCalendar</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GetYearToDateRevenue</span><span class="p">(</span><span class="n">agreement</span><span class="p">.</span><span class="n">SiteId</span><span class="p">),</span>
<span class="w">        </span><span class="n">AccumulationType</span><span class="p">.</span><span class="n">AnnualAnniversary</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">GetContractYearRevenue</span><span class="p">(</span><span class="n">agreement</span><span class="p">.</span><span class="n">SiteId</span><span class="p">,</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">ContractStartDate</span><span class="p">),</span>
<span class="w">        </span><span class="n">_</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">profitShareRevenue</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nf">ApplyTieredCalculation</span><span class="p">(</span><span class="n">accumulatedRevenue</span><span class="p">,</span><span class="w"> </span><span class="n">agreement</span><span class="p">.</span><span class="n">ProfitShareTiers</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Tier Application Logic</strong>:
<div class="highlight"><pre><span></span><code><span class="k">private</span><span class="w"> </span><span class="kt">decimal</span><span class="w"> </span><span class="nf">ApplyTieredCalculation</span><span class="p">(</span><span class="kt">decimal</span><span class="w"> </span><span class="n">revenue</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ProfitShareTier</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tiers</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="kt">decimal</span><span class="w"> </span><span class="n">totalProfitShare</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0m</span><span class="p">;</span>
<span class="w">    </span><span class="kt">decimal</span><span class="w"> </span><span class="n">remainingRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">revenue</span><span class="p">;</span>

<span class="w">    </span><span class="k">foreach</span><span class="w"> </span><span class="p">(</span><span class="kt">var</span><span class="w"> </span><span class="n">tier</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">tiers</span><span class="p">.</span><span class="n">OrderBy</span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">ThresholdAmount</span><span class="p">))</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">remainingRevenue</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="kt">var</span><span class="w"> </span><span class="n">tierRevenue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Math</span><span class="p">.</span><span class="n">Min</span><span class="p">(</span><span class="n">remainingRevenue</span><span class="p">,</span><span class="w"> </span><span class="n">tier</span><span class="p">.</span><span class="n">ThresholdAmount</span><span class="p">);</span>
<span class="w">        </span><span class="n">totalProfitShare</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">tierRevenue</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tier</span><span class="p">.</span><span class="n">Percentage</span><span class="p">;</span>
<span class="w">        </span><span class="n">remainingRevenue</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">tierRevenue</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">totalProfitShare</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Critical Integration Requirements</strong>:
- <strong>Execution Order</strong>: Must execute LAST in calculator sequence (Order: 4)
- <strong>Dependency Management</strong>: Requires outputs from all other calculators
- <strong>Revenue Adjustment</strong>: When profit share enabled, subtract component totals from Internal Revenue to prevent double-counting
- <strong>Escalator Support</strong>: Percentage rates and threshold amounts subject to escalation</p>
<h2 id="user-story-breakdown-and-sprint-planning">User Story Breakdown and Sprint Planning</h2>
<h3 id="story-point-allocation">Story Point Allocation</h3>
<table>
<thead>
<tr>
<th>User Story</th>
<th>Component</th>
<th>Complexity</th>
<th>Story Points</th>
<th>Key Technical Challenges</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>2423</strong></td>
<td>Management Fee Calculator</td>
<td>Medium</td>
<td>5</td>
<td>Multiple calculation branches, escalator integration</td>
</tr>
<tr>
<td><strong>2424</strong></td>
<td>Insurance/Claims Calculator</td>
<td>High</td>
<td>13</td>
<td>Complex cap logic, ETL schema changes, historical data aggregation</td>
</tr>
<tr>
<td><strong>2427</strong></td>
<td>Non-GL Expenses Calculator</td>
<td>Medium</td>
<td>8</td>
<td>Payroll type clarification, percentage calculations</td>
</tr>
<tr>
<td><strong>2426</strong></td>
<td>Profit Share Calculator</td>
<td>High</td>
<td>13</td>
<td>Execution ordering, revenue aggregation, tier processing</td>
</tr>
<tr>
<td><strong>2428</strong></td>
<td>Statistics Display</td>
<td>Low</td>
<td>5</td>
<td>UI enhancements, EDW API query optimization</td>
</tr>
</tbody>
</table>
<p><strong>Total Sprint Capacity</strong>: 44 story points<br/>
<strong>Sprint Duration</strong>: 4 weeks<br/>
<strong>Team Velocity</strong>: 11 points per week average</p>
<h3 id="sprint-28-execution-plan">Sprint 28 Execution Plan</h3>
<p><strong>Week 1: Foundation and Management Fee</strong>
- Implement calculator framework and interface
- Develop Management Fee calculator with all three calculation branches
- Unit testing for management fee calculations</p>
<p><strong>Week 2: Insurance and Claims Processing</strong>
- Implement Insurance and Claims calculator
- Execute ETL schema changes for vehicle insurance and claims accounts
- Develop complex claims cap logic with historical data aggregation</p>
<p><strong>Week 3: Non-GL and Profit Share</strong>
- Implement Non-GL Expenses calculator
- Develop Profit Share calculator with tier processing
- Integration testing between all calculators</p>
<p><strong>Week 4: Integration and UI</strong>
- Complete calculator framework integration
- Implement Statistics Display UI enhancements
- End-to-end testing and performance optimization</p>
<h2 id="outstanding-questions-and-risk-assessment">Outstanding Questions and Risk Assessment</h2>
<h3 id="critical-clarifications-required">Critical Clarifications Required</h3>
<h4 id="1-payroll-type-definitions">1. Payroll Type Definitions</h4>
<p><strong>Question</strong>: Exact definition of "billable" vs "total" payroll for non-GL expense calculations<br/>
<strong>Current Understanding</strong>: 
- <strong>Billable Payroll</strong>: PTEB base amount
- <strong>Total Payroll</strong>: PTEB base amount + PTEB total from P&amp;L
<strong>Action Required</strong>: Confirmation with Jonathan Aulson<br/>
<strong>Risk Level</strong>: High - Affects billing accuracy</p>
<h4 id="2-claims-account-configuration">2. Claims Account Configuration</h4>
<p><strong>Question</strong>: Complete list of claims account codes beyond 7099, 7100<br/>
<strong>Action Required</strong>: Review billable expense configuration for all claims-related accounts<br/>
<strong>Risk Level</strong>: Medium - May miss claims in calculations</p>
<h4 id="3-non-billable-expense-logic">3. Non-Billable Expense Logic</h4>
<p><strong>Question</strong>: Definition and usage of "non-billable expense amount" in profit share calculation<br/>
<strong>Current Status</strong>: Not found in current implementation, may be deprecated<br/>
<strong>Action Required</strong>: Verify if this logic is still required<br/>
<strong>Risk Level</strong>: Low - May be legacy requirement</p>
<h3 id="risk-assessment-matrix">Risk Assessment Matrix</h3>
<h4 id="high-risk-items">High Risk Items</h4>
<ol>
<li><strong>Complex Claims Cap Logic</strong>: Multiple cap types with different date calculations</li>
<li><strong>Mitigation</strong>: Comprehensive unit testing with historical data scenarios</li>
<li>
<p><strong>Contingency</strong>: Phased rollout with manual validation</p>
</li>
<li>
<p><strong>Profit Share Integration</strong>: Risk of double-counting revenue components</p>
</li>
<li><strong>Mitigation</strong>: Integration testing with full calculation flow</li>
<li>
<p><strong>Contingency</strong>: Revenue reconciliation reports</p>
</li>
<li>
<p><strong>Performance Impact</strong>: Additional calculations may affect P&amp;L generation time</p>
</li>
<li><strong>Mitigation</strong>: Performance monitoring and ETL optimization</li>
<li><strong>Contingency</strong>: Asynchronous processing for complex calculations</li>
</ol>
<h4 id="medium-risk-items">Medium Risk Items</h4>
<ol>
<li><strong>ETL Process Changes</strong>: Database schema modifications require careful deployment</li>
<li><strong>Mitigation</strong>: Database migration scripts with rollback procedures</li>
<li>
<p><strong>Contingency</strong>: Blue-green deployment strategy</p>
</li>
<li>
<p><strong>Calculator Ordering</strong>: Dependency management between calculators</p>
</li>
<li><strong>Mitigation</strong>: Dependency injection with explicit ordering</li>
<li>
<p><strong>Contingency</strong>: Manual execution order validation</p>
</li>
<li>
<p><strong>Configuration Complexity</strong>: Multiple configuration points for each calculator type</p>
</li>
<li><strong>Mitigation</strong>: Configuration validation and default value handling</li>
<li><strong>Contingency</strong>: Configuration migration tools</li>
</ol>
<h2 id="integration-points-and-dependencies">Integration Points and Dependencies</h2>
<h3 id="existing-system-dependencies">Existing System Dependencies</h3>
<ul>
<li><strong>Billable Accounts Calculator</strong>: Provides base calculations for management agreement processing</li>
<li><strong>Internal Revenue Service</strong>: Aggregates all calculator outputs into final revenue figures</li>
<li><strong>PTEB Calculator</strong>: Provides payroll base amounts and totals for percentage calculations</li>
<li><strong>External Revenue Calculator</strong>: Provides revenue figures for percentage-based calculations</li>
<li><strong>Escalator Service</strong>: Applies escalation rules to rates and thresholds</li>
</ul>
<h3 id="new-system-requirements">New System Requirements</h3>
<ul>
<li><strong>Management Agreement Interface</strong>: New interface for calculator implementations</li>
<li><strong>Calculator Ordering System</strong>: Ensures proper execution sequence and dependency management</li>
<li><strong>ETL Process Updates</strong>: Additional columns and account aggregations in data warehouse</li>
<li><strong>Configuration Management</strong>: Enhanced configuration system for complex calculator settings</li>
</ul>
<h3 id="api-integration-points">API Integration Points</h3>
<ul>
<li><strong>EDW API</strong>: Minimize calls to prevent performance degradation</li>
<li><strong>Legion Workforce API</strong>: Job code and hours data for per labor hour calculations</li>
<li><strong>Power Platform Flows</strong>: Integration with existing workflow systems</li>
<li><strong>Great Plains ERP</strong>: Account data and financial reporting integration</li>
</ul>
<h2 id="performance-optimization-strategy">Performance Optimization Strategy</h2>
<h3 id="current-performance-baseline">Current Performance Baseline</h3>
<ul>
<li><strong>P&amp;L API Call</strong>: 26 seconds for 2 sites</li>
<li><strong>Target Performance</strong>: Maintain current performance levels with additional calculations</li>
<li><strong>Optimization Approach</strong>: ETL-based data over additional API calls</li>
</ul>
<h3 id="optimization-techniques">Optimization Techniques</h3>
<ol>
<li><strong>Pre-calculation in ETL</strong>: Move complex aggregations to ETL process</li>
<li><strong>Caching Strategy</strong>: Cache frequently accessed configuration data</li>
<li><strong>Batch Processing</strong>: Process similar contract types together</li>
<li><strong>Asynchronous Processing</strong>: Non-blocking calculations where possible</li>
</ol>
<h3 id="monitoring-and-alerting">Monitoring and Alerting</h3>
<ul>
<li><strong>Performance Metrics</strong>: Track calculation execution times</li>
<li><strong>Error Monitoring</strong>: Alert on calculation failures or data inconsistencies</li>
<li><strong>Business Metrics</strong>: Monitor revenue calculation accuracy and completeness</li>
</ul>
<h2 id="code-validation-and-quality-assurance">Code Validation and Quality Assurance</h2>
<h3 id="validation-requirements">Validation Requirements</h3>
<p><strong>Validation Scope</strong>: All business rule calculations must be validated against existing Power Platform implementation</p>
<p><strong>Source Code Locations for Validation</strong>:
- Management Agreement flows in Power Platform solution
- Billable accounts calculation logic in existing system
- Insurance and claims processing flows
- Profit share calculation implementations in current workflows</p>
<p><strong>Validation Process</strong>: 
1. Compare documented calculation logic with actual Power Platform formula implementations
2. Ensure accuracy and completeness of business rule translations
3. Validate data flow and integration points
4. Confirm escalator logic consistency</p>
<h3 id="testing-strategy">Testing Strategy</h3>
<ol>
<li><strong>Unit Testing</strong>: Individual calculator testing with mock data</li>
<li><strong>Integration Testing</strong>: Full calculation flow with real data scenarios</li>
<li><strong>Performance Testing</strong>: Load testing with multiple sites and complex configurations</li>
<li><strong>User Acceptance Testing</strong>: Business stakeholder validation of calculation results</li>
</ol>
<h2 id="related-documentation-and-cross-references">Related Documentation and Cross-References</h2>
<ul>
<li><a href="../validation-reports/management-agreement-code-validation-report.md">Management Agreement Code Validation Report</a>  VALIDATED</li>
<li><a href="../../Future_State_Data_Product/technical/forecasting/20250718_Forecasting_BillableAccounts_TechnicalSpec.md">Billable Accounts Technical Specification</a>  REQUIRES_VALIDATION</li>
<li><a href="../../Future_State_Data_Product/configuration/contracts/">Contract Configuration Guide</a>  REQUIRES_VALIDATION</li>
<li><a href="../../Future_State_Data_Product/technical/backend/">Internal Revenue Calculation Patterns</a>  PLANNED</li>
<li><a href="../../Future_State_Data_Product/technical/integrations/20250724_EDW_Integration_TechnicalSpec.md">ETL Process Documentation</a>  REQUIRES_VALIDATION</li>
<li><a href="../standards/fibo-financial-ontology-integration.md">FIBO Financial Ontology Integration</a>  PLANNED</li>
</ul>
<h2 id="implementation-audit-trail">Implementation Audit Trail</h2>
<p><strong>Meeting Date</strong>: July 2, 2025<br/>
<strong>Documentation Date</strong>: August 6, 2025<br/>
<strong>Knowledge Corpus Integration</strong>: August 7, 2025<br/>
<strong>Sprint Execution</strong>: Sprint 28 (July 2025)<br/>
<strong>Code Validation Status</strong>: Validated against Power Platform implementation  </p>
<p><strong>Key Decision Makers</strong>:
- <strong>Technical Architecture</strong>: Andrew Scheuer, Cesar Figueroa
- <strong>Business Requirements</strong>: Jonathan Aulson
- <strong>Implementation Team</strong>: Javier Casas, Graham Olson, Christopher Thompson</p>
<p><strong>Quality Assurance</strong>:
- <strong>Technical Review</strong>: Completed by technical lead
- <strong>Business Validation</strong>: Pending payroll type clarification
- <strong>Code Validation</strong>: Cross-referenced with Power Platform implementation</p>
<hr/>
<p><em>This comprehensive meeting transcript captures the complete technical architecture and implementation strategy for the Management Agreement calculator system, ensuring all business logic, technical decisions, and implementation details are preserved for successful sprint execution and future system maintenance.</em></p>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="Last update">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="August 8, 2025 16:10:01 UTC">August 8, 2025</span>
</span>
</aside>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
<script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
<script src="../../../javascripts/extra.js"></script>
</body>
</html>